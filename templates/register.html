<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>[Astroport] : G1Visa Application : _HOSTNAME_ :: _IPFSNODEID_ </title>
    <meta http-equiv="refresh" content="9999; url='http://127.0.0.1:12345'" />
    <link rel="icon" type="image/png" href="http://127.0.0.1:8080/ipfs/QmaCh8mywWfxkXF3JziFzqZS6yZFo3eNS5fSfnzJqdSQvX/logo.png" />
    <link rel="stylesheet" href="http://127.0.0.1:8080/ipfs/QmaCh8mywWfxkXF3JziFzqZS6yZFo3eNS5fSfnzJqdSQvX/decoration.css" type="text/css" />
    <link rel="stylesheet" href="http://127.0.0.1:8080/ipfs/QmaCh8mywWfxkXF3JziFzqZS6yZFo3eNS5fSfnzJqdSQvX/layout.css" type="text/css" />
    <style>
body {
    background-image:url("http://127.0.0.1:8080/ipfs/QmSFgatcq3q898J56epa8SyGbH651vRBFnv93kQSwfoi83/background.000.jpg");
    background-repeat: no-repeat;
    background-size: 100% 100%;
}
html {
    height: 100%
}
header {
    opacity: 0.8;
}
    input[type=submit] {
    width: 12em;  height: 4em;
    }
    input[type=checkbox] {
    width: 2em;  height: 2em;
    }
    input {
    width: 26em;  height: 2em;
    }
#yellow {
      background: yellow;
      position: absolute;
      top: 15%;
      right: 6%;
      width: 180;
      visibility: hidden;
    }
#login {
    right: 10%;
    top: 5%
 }
         #countdown {
             display: flex;
             justify-content: center;
             align-items: center;
             color: #0e2c4c;
             font-size: 40px;
             width: 200px;
             height: 125px;
             background-color: #e7d9fc;
             border-radius: 50%;
             }
#aframe {
  background: white;
  color: black;
}

#console {
    visibility: hidden;
    background: rgba(0, 0, 0, 0.7); /* Adjust the background color and opacity as needed */
    color: white;
    width: 570px;
    height: 570px;
    position: absolute;
    bottom: 0;
    left: 0;
    padding: 5px;
    box-sizing: border-box;
}

    </style>
    <!-- Astro API JS LIB -->
    <script src="http://127.0.0.1:8080/ipfs/Qmae5v9zydax9u6C9ceDijURu5PYdd5avmv4NkenCw7RFv/astro.js"></script>
    <script>
    // Prepare QRCode generator for this same page
    var currentURL = window.location.href;
    const amzURL = encodeURIComponent(currentURL);
    const rooturl = currentURL.split('/?')[0];

    const qrURL = `${rooturl}/?amzqr=${amzURL}&logo=G1WorldMap`;
    console.log('qrURL = ' + qrURL);
    </script>
</head>
<body>
<header>

<!--
            <div  id="login"><button onclick="promptUser('login')">LOGIN</button><button onclick="promptUser('logout')">LOGOUT</button></div>
-->
<!--
         <div>
        <button onclick="homeAstroportStation('/?qrcode=station', 'tab', 33000)">ƒû1Station</button>
        </div>
-->
        <span><div id="ainfo"></div></span>
        <div id="debug"></div>
        <button onclick="document.getElementById('console').style.visibility = 'visible'; homeAstroportStation( qrURL, 'aframe', 7000);">UMap QR</button>

</header>

<main>

<center>
<b>Welkom - Mir√´ se vini -  Willkommen - Welkomma - Welcome - Marhaban - Bari galoust - Xos gelmissiniz - Welkum -  Ongi etorri- Swagata - Ansuf yiswen - ≈°ƒçyra zapra≈°ajem - Kyo tzo pa eit - ‡•ê‚òÖ‡•ê - Ani ki√© - Dobro do≈°li - Dagemer mat - Dobre dosh≈≠l - Benvinguts - Ulihebisdi - ‡Øê- HuƒÅn y√≠ng - Karibu - Eoso eoseyo - Benvenuti - Bel bonjou - Bienvini - Dobrodo≈°li - Velkommen - Bienvenido -  Bonvenon - Tere tulemast - Gabit√™ - V√¶lkomin -  Tervetuloa - Welkom - W√¨llk√≤mme - Binvignut - F√†ilte - Benvido - Croeso - Planvenguda - Mikouab√¥ - Kalos irthate - Eguah√© por√° - Baroukh habaim - Ô∑Ω </b><br>
<header>

<form id="formlink" action = "http://127.0.0.1:1234" method = "GET" enctype="application/x-www-form-urlencoded">

    <h1><a href="/">U</a><span>Planet</span>
    <br><span><a id="satLink" href="#" title="Sat">&nbsp;*&nbsp;</a>(<a href="https://ipfs.copylaradio.com/ipns/copylaradio.com">qo-op</a>)<a id="mapLink" href="#" title="Map">&nbsp;*&nbsp;</a></span></h1>
<span>Umap</span> [<span id='LAT'></span>]-[<span id='LON'></span>] <span>registration</span><br>

        <span>Email : </span><input name=uplanet value=''></br>

    <div id="yellow">
        <input name='salt' value='0.00'>
        <h3><a target="info" title="CHECK PORT" href="http://127.0.0.1:12345"> >>> (‚óï‚Äø‚Äø‚óï) <<< </a>
        </h3>
        <input name='pepper' value='0.00'><br>
    </div>
        <input type=hidden name=g1pub value=''></br>

        <input id='submit' type='submit' value='[(‚ô•‚Äø‚Äø‚ô•)]'>
        <span id='countdown'>UPlanet</span>


</form>

            <div id="console"><a href="https://pad.p2p.legal/s/Astroport.ONE#Application-name--U-Planet" target="aframe"> IMAGINE ____________</a> <button onclick="document.getElementById('console').style.visibility = 'hidden';">close</button>
                <iframe name="aframe" id="aframe" src="https://pad.p2p.legal/s/Astroport.ONE#Application-name--U-Planet" width="100%" height="100%"></iframe>
            </div>

<br>
   <span><a href="https://pad.p2p.legal/s/Astroport.ONE">Astroport</a>.<a href="https://github.com/papiche/Astroport.ONE">ONE</a>
   <br> - Crypto Commons Playground -</span>
    <h2>

        <form method='get' action='http://g1billet.localhost:33101' target='aframe'>
            <input type='hidden' name='montant' value='0' >
            <label for='type'>Type :</label>
            <select name='type'>
                <option value=''>G1BILLET+ ( x 6 )</option>
                <option value='jeu'>G1CARD</option>
                <option value='xastro' selected>G1CARD+TW</option>
                <option value='@astroport'>G1CARD+@</option>
            </select>
            <input type='hidden' name='dice' value='4' >&nbsp;&nbsp;&nbsp;&nbsp;
            <button type='submit'>get more wallets...</button>
        </form>

   </h2>
<br>
<a href="https://opencollective.com/monnaie-libre/" target="funding">- (^‚Äø‚Äø^) -</a>
</main>
</body>
<script>
  // Extract latitude and longitude from URL parameters
document.addEventListener('DOMContentLoaded', function() {
  const urlParams = new URLSearchParams(window.location.search);
  const salt = urlParams.get('salt');
  const pepper = urlParams.get('pepper');
  const uplanet = urlParams.get('uplanet');

  // Set latitude and longitude values to hidden inputs
  const latElement = document.querySelector('input[name="salt"]');
  const lonElement = document.querySelector('input[name="pepper"]');
  const uplanetElement = document.querySelector('input[name="uplanet"]');
  const passElement = document.querySelector('input[name="g1pub"]');

 //~ // Generate a random 6-digit number and set it as the default value for "PASS"
  if (passElement) {
    const randomPass = Math.floor(100000 + Math.random() * 900000); // Generates a random 6-digit number
    passElement.value = randomPass.toString();
  }

    if (latElement && lonElement) {
        latElement.value = salt || '0.00'; // Default to '0.00' if lat is missing
        lonElement.value = pepper || '0.00'; // Default to '0.00' if lon is missing
        uplanetElement.value = uplanet || '@'; // Default to '0.00' if lon is missing
    }

    // Decalage de - 0.05¬∞ = MAP coord SW
    var latMAP = (parseFloat(latElement.value) - 0.05).toFixed(2); // Subtract 0.05 from latElement
    var lonMAP = (parseFloat(lonElement.value) - 0.05).toFixed(2); // Subtract 0.05 from lonElement

    const satURL = `https://ipfs.copylaradio.com/ipfs/Qmduhh6ERX74dx1LhJzB4Bw3ZzM91kAqmPE47BVfMWwYfm/sat_render.html?southWestLat=${latMAP}&southWestLon=${lonMAP}&deg=0.1`;
    document.getElementById("satLink").href = satURL;
    const mapURL = `https://ipfs.copylaradio.com/ipfs/Qmduhh6ERX74dx1LhJzB4Bw3ZzM91kAqmPE47BVfMWwYfm/map_render.html?southWestLat=${latMAP}&southWestLon=${lonMAP}&deg=0.1`;
    document.getElementById("mapLink").href = mapURL;

    document.getElementById("LAT").innerHTML = latElement.value ;
    document.getElementById("LON").innerHTML = lonElement.value ;

    if (uplanetElement.value === "@" || uplanetElement.value === "") {
      // Hide the countdown div
      const countdownDiv = document.getElementById('countdown');
      if (countdownDiv) { // Check if the element exists
        countdownDiv.style.visibility = 'hidden';
      }
   } else {
        const submitDiv = document.getElementById('submit');
          if (submitDiv) { // Check if the element exists
            submitDiv.style.visibility = 'hidden';
          }
    }


});

</script>

<script>
const el = document.getElementById('yellow');

setTimeout(() => {
    el.style.visibility = 'visible';
}, 5456); // üëàÔ∏è delay in milliseconds

var arrTimes = [];
var i = 0; // start
var timesToTest = 3;
var tThreshold = 300; //ms
var testImage = "https://ipfs.copylaradio.com/ipfs/QmUUyiuCM4yXgaeGyqC2SVUUXZksuxhDfHQYpUpZPuL2oS/astroport.jpg"; // small image in your server
var dummyImage = new Image();
var isConnectedFast = false;

testLatency(function(avg){
  isConnectedFast = (avg <= tThreshold);
  /** output */
  document.body.appendChild(
    document.createTextNode("- IPFS swarm delay - " + (avg.toFixed(2)) + "ms - ‚ô•Box ready ? " + isConnectedFast)
  );
});

/** test and average time took to download image from server, called recursively timesToTest times */
function testLatency(cb) {
  var tStart = new Date().getTime();
  if (i<timesToTest-1) {
    dummyImage.src = testImage + '?t=' + tStart;
    dummyImage.onload = function() {
      var tEnd = new Date().getTime();
      var tTimeTook = tEnd-tStart;
      arrTimes[i] = tTimeTook;
      testLatency(cb);
      i++;
    };
  } else {
    /** calculate average of array items then callback */
    var sum = arrTimes.reduce(function(a, b) { return a + b; });
    var avg = sum / arrTimes.length;
    cb(avg);
  }
}

</script>
<script>

    let cookies = document.cookie;
    console.log(cookies);

    document.getElementById("countdown").innerHTML = "";

    var timeLeft = 90;
    var elem = document.getElementById("countdown");
    var timerId = setInterval(countdown, 999);

    function countdown() {
        if (timeLeft == -1) {
            document.getElementById('countdown').style.visibility = 'visible';
            clearTimeout(timerId);
            elem.innerHTML = "<a href=http://127.0.0.1:12345 target='aframe'>RETRY</a>"
            document.getElementById('aframe').src = 'http://127.0.0.1:12345';
            document.getElementById('console').style.visibility = 'visible';
        } else {
            elem.innerHTML = timeLeft + " s";
            timeLeft--;
        }
    }
    // promptUser();
</script>


</html>
